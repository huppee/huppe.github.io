<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>程序设计小作业 | huppe's Blog</title><meta name="author" content="huppe"><meta name="copyright" content="huppe"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MyElderlyApp：一款面向中老年用户的综合性 Android 应用 摘要本文介绍了一个名为 MyElderlyApp 的 Android 应用，面向中老年用户，集成了健康管理、快捷出行、文艺社区及多款休闲小游戏（五子棋、中国象棋、围棋、麻将）。文章从项目定位、技术选型、核心功能、实现关键点等方面进行详尽阐述，并附上完整的 Kotlin 源码供读者参考。   目录 项目背景与定位  技术栈与">
<meta property="og:type" content="article">
<meta property="og:title" content="程序设计小作业">
<meta property="og:url" content="https://huppee.github.io/huppe.github.io/2025/06/03/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%B0%8F%E4%BD%9C%E4%B8%9A/">
<meta property="og:site_name" content="huppe&#39;s Blog">
<meta property="og:description" content="MyElderlyApp：一款面向中老年用户的综合性 Android 应用 摘要本文介绍了一个名为 MyElderlyApp 的 Android 应用，面向中老年用户，集成了健康管理、快捷出行、文艺社区及多款休闲小游戏（五子棋、中国象棋、围棋、麻将）。文章从项目定位、技术选型、核心功能、实现关键点等方面进行详尽阐述，并附上完整的 Kotlin 源码供读者参考。   目录 项目背景与定位  技术栈与">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://huppee.github.io/huppe.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-06-03T10:00:00.000Z">
<meta property="article:modified_time" content="2025-06-03T11:13:20.324Z">
<meta property="article:author" content="huppe">
<meta property="article:tag" content="软件开发">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://huppee.github.io/huppe.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "程序设计小作业",
  "url": "https://huppee.github.io/huppe.github.io/2025/06/03/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%B0%8F%E4%BD%9C%E4%B8%9A/",
  "image": "https://huppee.github.io/huppe.github.io/img/butterfly-icon.png",
  "datePublished": "2025-06-03T10:00:00.000Z",
  "dateModified": "2025-06-03T11:13:20.324Z",
  "author": [
    {
      "@type": "Person",
      "name": "huppe",
      "url": "https://huppee.github.io/huppe.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/huppe.github.io/img/favicon.png"><link rel="canonical" href="https://huppee.github.io/huppe.github.io/2025/06/03/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%B0%8F%E4%BD%9C%E4%B8%9A/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/huppe.github.io/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><!-- 添加 Live2D 看板娘 CSS--><link rel="stylesheet" href="/huppe.github.io/live2d-widget/waifu.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/huppe.github.io/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '程序设计小作业',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/huppe.github.io/feed.xml" title="huppe's Blog" type="application/rss+xml">
</head><body><div id="particles-js"></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/huppe.github.io/"><span class="site-name">huppe's Blog</span></a><a class="nav-page-title" href="/huppe.github.io/"><span class="site-name">程序设计小作业</span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">程序设计小作业</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-06-03T10:00:00.000Z" title="发表于 2025-06-03 18:00:00">2025-06-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-06-03T11:13:20.324Z" title="更新于 2025-06-03 19:13:20">2025-06-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/huppe.github.io/categories/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/">软件开发</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="MyElderlyApp：一款面向中老年用户的综合性-Android-应用"><a href="#MyElderlyApp：一款面向中老年用户的综合性-Android-应用" class="headerlink" title="MyElderlyApp：一款面向中老年用户的综合性 Android 应用"></a>MyElderlyApp：一款面向中老年用户的综合性 Android 应用</h1><blockquote>
<p><strong>摘要</strong><br>本文介绍了一个名为 <strong>MyElderlyApp</strong> 的 Android 应用，面向中老年用户，集成了健康管理、快捷出行、文艺社区及多款休闲小游戏（五子棋、中国象棋、围棋、麻将）。文章从项目定位、技术选型、核心功能、实现关键点等方面进行详尽阐述，并附上完整的 Kotlin 源码供读者参考。</p>
</blockquote>
<hr>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ol>
<li><p><a href="#%E9%A1%B9%E7%9B%AE%E8%83%8C%E6%99%AF%E4%B8%8E%E5%AE%9A%E4%BD%8D">项目背景与定位</a></p>
</li>
<li><p><a href="#%E6%8A%80%E6%9C%AF%E6%A0%88%E4%B8%8E%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88">技术栈与架构概览</a></p>
</li>
<li><p><a href="#%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97%E4%BB%8B%E7%BB%8D">核心功能模块介绍</a></p>
<ol>
<li><a href="#%E7%99%BB%E5%BD%95%E4%B8%8E%E4%B8%BB%E7%95%8C%E9%9D%A2">登录与主界面</a></li>
<li><a href="#%E5%BF%AB%E6%8D%B7%E5%87%BA%E8%A1%8C-quicktravelscreen">快捷出行 (QuickTravelScreen)</a></li>
<li><a href="#%E5%81%A5%E5%BA%B7%E7%AE%A1%E7%90%86-healthscreen">健康管理 (HealthScreen)</a></li>
<li><a href="#%E6%96%87%E8%89%BA%E7%A4%BE%E5%8C%BA-artcommunityscreen">文艺社区 (ArtCommunityScreen)</a></li>
<li><a href="#%E4%BA%94%E5%AD%90%E6%A3%8B-gomokuscreen">五子棋 (GomokuScreen)</a></li>
<li><a href="#%E4%B8%AD%E5%9B%BD%E8%B1%A1%E6%A3%8B-chessscreen">中国象棋 (ChessScreen)</a></li>
<li><a href="#%E5%9B%B4%E6%A3%8B-gogamescreen">围棋 (GoGameScreen)</a></li>
<li><a href="#%E9%BA%BB%E5%B0%86-mahjongscreen">麻将 (MahjongScreen)</a></li>
</ol>
</li>
<li><p><a href="#%E5%AE%9E%E7%8E%B0%E5%85%B3%E9%94%AE%E7%82%B9%E8%A7%A3%E6%9E%90">实现关键点解析</a></p>
</li>
<li><p><a href="#%E9%A1%B9%E7%9B%AE%E6%BA%90%E7%A0%81Markdown-%E6%A0%BC%E5%BC%8F">项目源码（Markdown 格式）</a></p>
<ol>
<li><a href="#loginscreenkt">LoginScreen.kt</a></li>
<li><a href="#mainactivitykt">MainActivity.kt</a></li>
<li><a href="#quicktravelscreenkt">QuickTravelScreen.kt</a></li>
<li><a href="#healthscreenkt">HealthScreen.kt</a></li>
<li><a href="#artcommunityscreenkt">ArtCommunityScreen.kt</a></li>
<li><a href="#gomokuscreenkt">GomokuScreen.kt</a></li>
<li><a href="#chessscreenkt">ChessScreen.kt</a></li>
<li><a href="#gogamescreenkt">GoGameScreen.kt</a></li>
<li><a href="#mahjongscreenkt">MahjongScreen.kt</a></li>
</ol>
</li>
<li><p><a href="#%E5%8F%AF%E6%94%B9%E8%BF%9B%E4%B8%8E%E6%9C%AA%E6%9D%A5%E5%B1%95%E6%9C%9B">可改进与未来展望</a></p>
</li>
<li><p><a href="#%E7%BB%93%E8%AF%AD">结语</a></p>
</li>
</ol>
<hr>
<h2 id="项目背景与定位"><a href="#项目背景与定位" class="headerlink" title="项目背景与定位"></a>项目背景与定位</h2><p>随着智能手机在中老年人群中的普及，如何设计一款 <strong>界面简洁、易操作</strong> 且功能实用的移动应用成为开发者关注的重点。“MyElderlyApp” 项目正是针对这一需求而诞生，目标是打造一款集出行、健康和娱乐于一体的“<strong>一站式</strong>” Android 应用，具体定位如下：</p>
<ul>
<li><p><strong>目标用户</strong>：中老年用户，他们对应用的易用性、字体大小、色彩对比有较高要求，同时更注重健康管理、便捷服务以及休闲娱乐。</p>
</li>
<li><p><strong>核心目标</strong>：</p>
<ol>
<li><strong>快捷出行</strong>：一键打车或查询公交，流程简单直观。</li>
<li><strong>健康管理</strong>：包括挂号、咨询、用药提醒等模块，让中老年用户快速获取医疗&#x2F;健康服务入口。</li>
<li><strong>文艺社区</strong>：提供一个轻松氛围的社区入口，配合 <strong>Lottie 动效</strong>，吸引用户参与。</li>
<li><strong>休闲小游戏</strong>：内置 <strong>五子棋</strong>、<strong>中国象棋</strong>、<strong>围棋</strong>、<strong>麻将</strong> 四款经典棋类游戏，满足用户娱乐需求。</li>
</ol>
</li>
</ul>
<hr>
<h2 id="技术栈与架构概览"><a href="#技术栈与架构概览" class="headerlink" title="技术栈与架构概览"></a>技术栈与架构概览</h2><ul>
<li><p><strong>语言 &amp; 框架</strong></p>
<ul>
<li>Kotlin + Jetpack Compose（Material 3）</li>
<li>AndroidX Navigation Compose</li>
<li>Lottie for Compose（动效展示）</li>
<li>Canvas &amp; 自定义 View</li>
</ul>
</li>
<li><p><strong>认证 &amp; 导航</strong></p>
<ul>
<li>使用 Firebase Authentication（邮箱&#x2F;密码）实现简单的用户注册与登录</li>
<li>采用单 Activity + 多 Composable 方案，通过 <code>NavHost</code> 管理各个界面路由</li>
</ul>
</li>
<li><p><strong>文件结构（核心）</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">├── MainActivity.kt          # Application 启动 Activity，负责 NavHost 注册</span><br><span class="line">├── LoginScreen.kt           # 登录 / 注册界面</span><br><span class="line">├── MainScreenImproved.kt    # 登录后主界面（底部导航 + 功能入口网格）</span><br><span class="line">├── QuickTravelScreen.kt     # 快捷出行模块</span><br><span class="line">├── HealthScreen.kt          # 健康管理模块</span><br><span class="line">├── ArtCommunityScreen.kt    # 文艺社区页面（宫格 + 动效 + 游戏入口）</span><br><span class="line">├── GomokuScreen.kt          # 五子棋</span><br><span class="line">├── ChessScreen.kt           # 中国象棋</span><br><span class="line">├── GoGameScreen.kt          # 围棋</span><br><span class="line">└── MahjongScreen.kt         # 麻将</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>主题 &amp; 配色</strong></p>
<ul>
<li>使用 Material 3 默认主题，主色调以暖色系为主，兼顾中老年用户视觉习惯</li>
<li>文艺社区模块使用中国风配色：米色背景 + 大红为主色，配以金黄色祥云动效</li>
</ul>
</li>
</ul>
<hr>
<h2 id="核心功能模块介绍"><a href="#核心功能模块介绍" class="headerlink" title="核心功能模块介绍"></a>核心功能模块介绍</h2><h3 id="登录与主界面"><a href="#登录与主界面" class="headerlink" title="登录与主界面"></a>登录与主界面</h3><ul>
<li><p><strong>登录界面（LoginScreen.kt）</strong></p>
<ul>
<li>支持注册 &#x2F; 登录切换</li>
<li>邮箱格式校验、密码长度限制</li>
<li>登录成功后，通过 <code>navController.navigate(&quot;main&quot;) &#123; popUpTo(&quot;login&quot;) inclusive=true &#125;</code> 保证登录页从返回栈中弹出</li>
<li>若网络状况差，则显示提示</li>
</ul>
</li>
<li><p><strong>主界面（MainScreenImproved.kt）</strong></p>
<ul>
<li>顶部渐变横幅 + 底部四个页签：快捷出行、健康管理、文艺社区、个人中心（可根据需求扩展）</li>
<li>文艺社区页签下使用 <code>LazyVerticalGrid</code> 以圆形卡片展示小游戏入口：五子棋、象棋、围棋、麻将</li>
</ul>
</li>
</ul>
<h3 id="快捷出行-QuickTravelScreen"><a href="#快捷出行-QuickTravelScreen" class="headerlink" title="快捷出行 (QuickTravelScreen)"></a>快捷出行 (QuickTravelScreen)</h3><ul>
<li><p><strong>功能描述</strong></p>
<ul>
<li>提供 <strong>滴滴打车</strong> 和 <strong>公交查询</strong> 按钮。</li>
<li>点击“打车”按钮，通过 Android 原生 Intent 调用 URI Scheme <code>didi://</code>；若检测到用户未安装滴滴，则跳转到应用商店。</li>
<li>点击“公交查询”按钮，直接跳转到指定的公交查询网页。</li>
<li>界面所有按钮文字较大，配色简洁，适合中老年人视力习惯。</li>
</ul>
</li>
</ul>
<h3 id="健康管理-HealthScreen"><a href="#健康管理-HealthScreen" class="headerlink" title="健康管理 (HealthScreen)"></a>健康管理 (HealthScreen)</h3><ul>
<li><p><strong>功能描述</strong></p>
<ul>
<li>三个大按钮：一键挂号、在线咨询、用药提醒</li>
<li>按钮占满整行宽度，文字居中，背景色采用暖色系。</li>
<li>目前为占位跳转（<code>navController.navigate(&quot;...&quot;)</code>），后续可接真实后端接口（如医院挂号 API、在线问诊服务、WorkManager 定时提醒等）。</li>
</ul>
</li>
</ul>
<h3 id="文艺社区-ArtCommunityScreen"><a href="#文艺社区-ArtCommunityScreen" class="headerlink" title="文艺社区 (ArtCommunityScreen)"></a>文艺社区 (ArtCommunityScreen)</h3><ul>
<li><p><strong>功能描述</strong></p>
<ul>
<li>主页采用卡片式宫格布局，每个卡片代表一个休闲小游戏入口（五子棋、象棋、围棋、麻将）。</li>
<li>卡片内嵌 <strong>Lottie 动效</strong>，吸引用户点击。</li>
<li>整体配色以米色为底、卡片边缘大红描边，符合中国传统审美，并兼顾中老年人视觉舒适度。</li>
</ul>
</li>
</ul>
<h3 id="五子棋-GomokuScreen"><a href="#五子棋-GomokuScreen" class="headerlink" title="五子棋 (GomokuScreen)"></a>五子棋 (GomokuScreen)</h3><ul>
<li><p><strong>界面与交互</strong></p>
<ul>
<li>使用 <strong>Compose Canvas</strong> 自绘 15×15 棋盘。</li>
<li>通过 <code>remember &#123; mutableStateListOf&lt;Point&gt;() &#125;</code> 存储落子坐标列表，根据当前玩家（黑 &#x2F; 白）交替渲染黑白棋子。</li>
<li>每次玩家落子后，调用胜负判定函数判断是否有人获胜，并在 Canvas 上方文案提示 “黑方获胜” &#x2F; “白方获胜”。</li>
<li>随机从 30 句棋局格言中挑选一句置于棋盘上方。</li>
</ul>
</li>
</ul>
<h3 id="中国象棋-ChessScreen"><a href="#中国象棋-ChessScreen" class="headerlink" title="中国象棋 (ChessScreen)"></a>中国象棋 (ChessScreen)</h3><ul>
<li><p><strong>界面与交互</strong></p>
<ul>
<li><p>由于象棋对路线、棋子形态要求更复杂，采用 Android 原生 <code>View</code>（Canvas）嵌入到 Compose：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AndroidView(</span><br><span class="line">  factory = &#123; context -&gt; ChessBoardView(context) &#125;,</span><br><span class="line">  modifier = Modifier.fillMaxSize()</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
<li><p>棋盘绘制：9×10 格阵，每个格子等宽，<code>drawLine</code> 画线；“楚河汉界”文字通过 <code>drawText</code> 标注。</p>
</li>
<li><p>棋子布局与规则判定：支持马脚、象眼、炮打隔子、将帅见面等规则，完整判断每一步是否合法。</p>
</li>
<li><p>右上角提供“重置”按钮，清空棋局、重置初始阵型。</p>
</li>
</ul>
</li>
</ul>
<h3 id="围棋-GoGameScreen"><a href="#围棋-GoGameScreen" class="headerlink" title="围棋 (GoGameScreen)"></a>围棋 (GoGameScreen)</h3><ul>
<li><p><strong>界面与交互</strong></p>
<ul>
<li>同样使用 Compose <code>Canvas</code> 自绘 19×19 格线。</li>
<li>通过 <code>mutableStateListOf&lt;Point&gt;()</code> 记录黑白棋子在网格交叉点的位置。</li>
<li>提供“悔棋”功能：维护 <code>moveHistory</code>，每次悔棋从列表末尾移除一子，并触发 UI 重绘。</li>
<li>简单 Ko 劫判定：对上一次吃子与当前落子位置进行对比，禁止同一形状重复循环。</li>
<li>提供“提子”逻辑：当一方围死对方无气时，移除对应棋子。</li>
</ul>
</li>
</ul>
<h3 id="麻将-MahjongScreen"><a href="#麻将-MahjongScreen" class="headerlink" title="麻将 (MahjongScreen)"></a>麻将 (MahjongScreen)</h3><ul>
<li><p><strong>界面与交互</strong></p>
<ul>
<li><p>限制为 4 人简化版麻将，强制横屏：通过 Compose 的 <code>DisposableEffect</code> 与 <code>LocalView</code> 强制将 Activity 设置为 <code>SCREEN_ORIENTATION_LANDSCAPE</code>。</p>
</li>
<li><p>牌面使用 Emoji 字符串渲染，例如 “🀐” 代表某张牌。</p>
</li>
<li><p>布局：</p>
<ul>
<li>玩家手牌在最下方，横排展示。</li>
<li>左右两家手牌竖排展示，牌背朝用户。</li>
<li>上家手牌横排倒置展示。</li>
<li>中央区域为当前出牌区与操作按钮，包括“碰”“杠”“胡”等操作（仅模拟展示，未接入完整胡牌算法）。</li>
</ul>
</li>
<li><p>UI 保持紧凑：手牌大小、位置经过多次调试，保证不需要滑动即可完整展示所有牌。</p>
</li>
</ul>
</li>
</ul>
<hr>
<h2 id="实现关键点解析"><a href="#实现关键点解析" class="headerlink" title="实现关键点解析"></a>实现关键点解析</h2><ol>
<li><p><strong>单 Activity + Compose 多路由</strong></p>
<ul>
<li><p>在 <code>MainActivity.kt</code> 中创建 <code>NavHost</code>：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">setContent &#123;</span><br><span class="line">  MyElderlyTheme &#123;</span><br><span class="line">    NavHost(</span><br><span class="line">      navController = navController,</span><br><span class="line">      startDestination = <span class="string">&quot;login&quot;</span></span><br><span class="line">    ) &#123;</span><br><span class="line">      composable(<span class="string">&quot;login&quot;</span>) &#123; LoginScreen(navController) &#125;</span><br><span class="line">      composable(<span class="string">&quot;main&quot;</span>) &#123; MainScreenImproved(navController) &#125;</span><br><span class="line">      composable(<span class="string">&quot;quick_travel&quot;</span>) &#123; QuickTravelScreen(navController) &#125;</span><br><span class="line">      <span class="comment">// … 其他路由 …</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>状态保存与 UI 通信</strong></p>
<ul>
<li>对于游戏模块，大量使用 <code>remember &#123; mutableStateOf(...) &#125;</code>、<code>remember &#123; mutableStateListOf(...) &#125;</code> 等方式管理状态</li>
<li>Compose 会自动根据 State 变化触发重组（Recompose），无需手动调用 <code>invalidate()</code></li>
</ul>
</li>
<li><p><strong>Canvas 自绘 vs AndroidView 嵌入原生 View</strong></p>
<ul>
<li><p><strong>五子棋、围棋</strong> 直接用 Compose Canvas，代码更简洁；示例：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Canvas(modifier = Modifier.fillMaxSize()) &#123;</span><br><span class="line">  <span class="keyword">val</span> width = size.width / <span class="number">15f</span></span><br><span class="line">  <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">0.</span><span class="number">.15</span>) &#123;</span><br><span class="line">    drawLine(color = Color.Black, start = Offset(i * width, <span class="number">0f</span>), end = Offset(i * width, size.height))</span><br><span class="line">    drawLine(color = Color.Black, start = Offset(<span class="number">0f</span>, i * width), end = Offset(size.width, i * width))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 渲染棋子</span></span><br><span class="line">  stonePositions.forEach &#123; (pt, isBlack) -&gt;</span><br><span class="line">    drawCircle(color = <span class="keyword">if</span> (isBlack) Color.Black <span class="keyword">else</span> Color.White,</span><br><span class="line">               radius = width * <span class="number">0.4f</span>,</span><br><span class="line">               center = Offset(pt.x * width, pt.y * width))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p><strong>中国象棋</strong> 由于判定逻辑更复杂，优先考虑性能与灵活性，用自定义 <code>View</code>（继承自 <code>View</code> 并重写 <code>onDraw()</code>）绘制。再通过 <code>AndroidView</code> 嵌入 Compose。</p>
</li>
</ul>
</li>
<li><p><strong>屏幕方向强制与资源管理（麻将模块）</strong></p>
<ul>
<li><p>在 <strong>MahjongScreen.kt</strong> 中：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DisposableEffect(<span class="built_in">Unit</span>) &#123;</span><br><span class="line">  <span class="keyword">val</span> activity = (LocalView.current.context <span class="keyword">as</span> Activity)</span><br><span class="line">  activity.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE</span><br><span class="line">  onDispose &#123; activity.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_SENSOR &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>动效集成</strong></p>
<ul>
<li>使用 <code>LottieAnimation(composition, iterations = LottieConstants.IterateForever, ...)</code> 加载 JSON 动效文件（存放在 <code>assets</code> 目录下），示例见 <code>ArtCommunityScreen.kt</code>。</li>
</ul>
</li>
<li><p><strong>Firebase Auth 初步接入（登录模块）</strong></p>
<ul>
<li>在 <code>LoginScreen.kt</code> 内部，通过 <code>Firebase.auth.createUserWithEmailAndPassword(...)</code> 或 <code>signInWithEmailAndPassword(...)</code> 完成注册&#x2F;登录逻辑，错误时直接在界面底部以 <code>Toast</code> 提示。</li>
</ul>
</li>
</ol>
<hr>
<h2 id="项目源码（Markdown-格式）"><a href="#项目源码（Markdown-格式）" class="headerlink" title="项目源码（Markdown 格式）"></a>项目源码（Markdown 格式）</h2><p>下面直接贴出每个 <code>.kt</code> 文件的完整内容，供您在博客中引用。所有代码均已按 Kotlin 语法高亮用三重反引号标注。</p>
<hr>
<h3 id="LoginScreen-kt"><a href="#LoginScreen-kt" class="headerlink" title="LoginScreen.kt"></a>LoginScreen.kt</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myelderlyapp</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Activity</span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.content.res.Configuration</span><br><span class="line"><span class="keyword">import</span> android.util.Patterns</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.Image</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.background</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.clickable</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.layout.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.shape.RoundedCornerShape</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.runtime.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Alignment</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Modifier</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.graphics.Brush</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.platform.LocalContext</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.res.painterResource</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.text.font.FontWeight</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.text.input.PasswordVisualTransformation</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.text.input.VisualTransformation</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.unit.dp</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.unit.sp</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.NavController</span><br><span class="line"><span class="keyword">import</span> com.google.firebase.auth.FirebaseAuth</span><br><span class="line"><span class="keyword">import</span> com.google.firebase.auth.ktx.auth</span><br><span class="line"><span class="keyword">import</span> com.google.firebase.ktx.Firebase</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">LoginScreen</span><span class="params">(navController: <span class="type">NavController</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> auth = Firebase.auth</span><br><span class="line">    <span class="keyword">var</span> email <span class="keyword">by</span> remember &#123; mutableStateOf(<span class="string">&quot;&quot;</span>) &#125;</span><br><span class="line">    <span class="keyword">var</span> password <span class="keyword">by</span> remember &#123; mutableStateOf(<span class="string">&quot;&quot;</span>) &#125;</span><br><span class="line">    <span class="keyword">var</span> isLoginMode <span class="keyword">by</span> remember &#123; mutableStateOf(<span class="literal">true</span>) &#125;</span><br><span class="line">    <span class="keyword">var</span> errorMsg <span class="keyword">by</span> remember &#123; mutableStateOf(<span class="string">&quot;&quot;</span>) &#125;</span><br><span class="line">    <span class="keyword">val</span> context = LocalContext.current</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 背景渐变</span></span><br><span class="line">    Box(modifier = Modifier.fillMaxSize()) &#123;</span><br><span class="line">        Canvas(modifier = Modifier.matchParentSize()) &#123;</span><br><span class="line">            drawRect(</span><br><span class="line">                brush = Brush.verticalGradient(</span><br><span class="line">                    colors = listOf(MaterialTheme.colorScheme.primary, MaterialTheme.colorScheme.primaryContainer)</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">        Column(</span><br><span class="line">            modifier = Modifier</span><br><span class="line">                .fillMaxSize()</span><br><span class="line">                .padding(<span class="number">32.</span>dp),</span><br><span class="line">            horizontalAlignment = Alignment.CenterHorizontally,</span><br><span class="line">            verticalArrangement = Arrangement.Center</span><br><span class="line">        ) &#123;</span><br><span class="line">            <span class="comment">// App Logo</span></span><br><span class="line">            Image(</span><br><span class="line">                painter = painterResource(id = R.drawable.app_logo),</span><br><span class="line">                contentDescription = <span class="string">&quot;App Logo&quot;</span>,</span><br><span class="line">                modifier = Modifier.size(<span class="number">100.</span>dp)</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">            Spacer(modifier = Modifier.height(<span class="number">24.</span>dp))</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 标题</span></span><br><span class="line">            Text(</span><br><span class="line">                text = <span class="keyword">if</span> (isLoginMode) <span class="string">&quot;登录 MyElderlyApp&quot;</span> <span class="keyword">else</span> <span class="string">&quot;注册 MyElderlyApp&quot;</span>,</span><br><span class="line">                color = MaterialTheme.colorScheme.onPrimaryContainer,</span><br><span class="line">                fontSize = <span class="number">24.</span>sp,</span><br><span class="line">                fontWeight = FontWeight.Bold</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">            Spacer(modifier = Modifier.height(<span class="number">16.</span>dp))</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 输入框：邮箱</span></span><br><span class="line">            OutlinedTextField(</span><br><span class="line">                value = email,</span><br><span class="line">                onValueChange = &#123; email = it &#125;,</span><br><span class="line">                label = &#123; Text(<span class="string">&quot;邮箱&quot;</span>) &#125;,</span><br><span class="line">                singleLine = <span class="literal">true</span>,</span><br><span class="line">                modifier = Modifier.fillMaxWidth()</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">            Spacer(modifier = Modifier.height(<span class="number">8.</span>dp))</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 输入框：密码</span></span><br><span class="line">            OutlinedTextField(</span><br><span class="line">                value = password,</span><br><span class="line">                onValueChange = &#123; password = it &#125;,</span><br><span class="line">                label = &#123; Text(<span class="string">&quot;密码（至少6位）&quot;</span>) &#125;,</span><br><span class="line">                singleLine = <span class="literal">true</span>,</span><br><span class="line">                visualTransformation = PasswordVisualTransformation(),</span><br><span class="line">                modifier = Modifier.fillMaxWidth()</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (errorMsg.isNotEmpty()) &#123;</span><br><span class="line">                Spacer(modifier = Modifier.height(<span class="number">8.</span>dp))</span><br><span class="line">                Text(text = errorMsg, color = MaterialTheme.colorScheme.error)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Spacer(modifier = Modifier.height(<span class="number">16.</span>dp))</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 登录 / 注册按钮</span></span><br><span class="line">            Button(</span><br><span class="line">                onClick = &#123;</span><br><span class="line">                    <span class="comment">// 简单校验</span></span><br><span class="line">                    <span class="keyword">if</span> (!Patterns.EMAIL_ADDRESS.matcher(email).matches()) &#123;</span><br><span class="line">                        errorMsg = <span class="string">&quot;请输入有效的邮箱地址&quot;</span></span><br><span class="line">                        <span class="keyword">return</span><span class="symbol">@Button</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (password.length &lt; <span class="number">6</span>) &#123;</span><br><span class="line">                        errorMsg = <span class="string">&quot;密码长度至少为6位&quot;</span></span><br><span class="line">                        <span class="keyword">return</span><span class="symbol">@Button</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    errorMsg = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (isLoginMode) &#123;</span><br><span class="line">                        <span class="comment">// 登录逻辑</span></span><br><span class="line">                        auth.signInWithEmailAndPassword(email, password)</span><br><span class="line">                            .addOnSuccessListener &#123;</span><br><span class="line">                                navController.navigate(<span class="string">&quot;main&quot;</span>) &#123;</span><br><span class="line">                                    popUpTo(<span class="string">&quot;login&quot;</span>) &#123; inclusive = <span class="literal">true</span> &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                            .addOnFailureListener &#123;</span><br><span class="line">                                errorMsg = <span class="string">&quot;登录失败：<span class="subst">$&#123;it.message&#125;</span>&quot;</span></span><br><span class="line">                            &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">// 注册逻辑</span></span><br><span class="line">                        auth.createUserWithEmailAndPassword(email, password)</span><br><span class="line">                            .addOnSuccessListener &#123;</span><br><span class="line">                                navController.navigate(<span class="string">&quot;main&quot;</span>) &#123;</span><br><span class="line">                                    popUpTo(<span class="string">&quot;login&quot;</span>) &#123; inclusive = <span class="literal">true</span> &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                            .addOnFailureListener &#123;</span><br><span class="line">                                errorMsg = <span class="string">&quot;注册失败：<span class="subst">$&#123;it.message&#125;</span>&quot;</span></span><br><span class="line">                            &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                modifier = Modifier</span><br><span class="line">                    .fillMaxWidth()</span><br><span class="line">                    .height(<span class="number">48.</span>dp),</span><br><span class="line">                shape = RoundedCornerShape(<span class="number">24.</span>dp)</span><br><span class="line">            ) &#123;</span><br><span class="line">                Text(</span><br><span class="line">                    text = <span class="keyword">if</span> (isLoginMode) <span class="string">&quot;登录&quot;</span> <span class="keyword">else</span> <span class="string">&quot;注册&quot;</span>,</span><br><span class="line">                    fontSize = <span class="number">16.</span>sp</span><br><span class="line">                )</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Spacer(modifier = Modifier.height(<span class="number">8.</span>dp))</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 切换登录/注册</span></span><br><span class="line">            Text(</span><br><span class="line">                text = <span class="keyword">if</span> (isLoginMode) <span class="string">&quot;还没有账号？去注册&quot;</span> <span class="keyword">else</span> <span class="string">&quot;已有账号？去登录&quot;</span>,</span><br><span class="line">                color = MaterialTheme.colorScheme.onPrimaryContainer,</span><br><span class="line">                modifier = Modifier.clickable &#123; isLoginMode = !isLoginMode &#125;</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="MainActivity-kt"><a href="#MainActivity-kt" class="headerlink" title="MainActivity.kt"></a>MainActivity.kt</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myelderlyapp</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Activity</span><br><span class="line"><span class="keyword">import</span> android.content.pm.ActivityInfo</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> androidx.activity.ComponentActivity</span><br><span class="line"><span class="keyword">import</span> androidx.activity.compose.setContent</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.ExperimentalMaterial3Api</span><br><span class="line"><span class="keyword">import</span> androidx.compose.runtime.Composable</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.platform.LocalView</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.NavType</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.compose.NavHost</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.compose.composable</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.compose.rememberNavController</span><br><span class="line"><span class="keyword">import</span> com.example.myelderlyapp.ui.theme.MyElderlyTheme</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">ComponentActivity</span>() &#123;</span><br><span class="line">    <span class="meta">@OptIn(ExperimentalMaterial3Api::class)</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContent &#123;</span><br><span class="line">            MyElderlyTheme &#123;</span><br><span class="line">                <span class="keyword">val</span> navController = rememberNavController()</span><br><span class="line">                NavHost(</span><br><span class="line">                    navController = navController,</span><br><span class="line">                    startDestination = <span class="string">&quot;login&quot;</span></span><br><span class="line">                ) &#123;</span><br><span class="line">                    composable(<span class="string">&quot;login&quot;</span>) &#123;</span><br><span class="line">                        LoginScreen(navController)</span><br><span class="line">                    &#125;</span><br><span class="line">                    composable(<span class="string">&quot;main&quot;</span>) &#123;</span><br><span class="line">                        MainScreenImproved(navController)</span><br><span class="line">                    &#125;</span><br><span class="line">                    composable(<span class="string">&quot;quick_travel&quot;</span>) &#123;</span><br><span class="line">                        QuickTravelScreen(navController)</span><br><span class="line">                    &#125;</span><br><span class="line">                    composable(<span class="string">&quot;health&quot;</span>) &#123;</span><br><span class="line">                        HealthScreen(navController)</span><br><span class="line">                    &#125;</span><br><span class="line">                    composable(<span class="string">&quot;community&quot;</span>) &#123;</span><br><span class="line">                        ArtCommunityScreen(navController)</span><br><span class="line">                    &#125;</span><br><span class="line">                    composable(<span class="string">&quot;gomoku&quot;</span>) &#123;</span><br><span class="line">                        GomokuScreen(navController)</span><br><span class="line">                    &#125;</span><br><span class="line">                    composable(<span class="string">&quot;chess&quot;</span>) &#123;</span><br><span class="line">                        ChessScreen(navController)</span><br><span class="line">                    &#125;</span><br><span class="line">                    composable(<span class="string">&quot;go&quot;</span>) &#123;</span><br><span class="line">                        GoGameScreen(navController)</span><br><span class="line">                    &#125;</span><br><span class="line">                    composable(<span class="string">&quot;mahjong&quot;</span>) &#123;</span><br><span class="line">                        MahjongScreen(navController)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="QuickTravelScreen-kt"><a href="#QuickTravelScreen-kt" class="headerlink" title="QuickTravelScreen.kt"></a>QuickTravelScreen.kt</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myelderlyapp</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Intent</span><br><span class="line"><span class="keyword">import</span> android.net.Uri</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.Image</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.background</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.clickable</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.layout.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.shape.RoundedCornerShape</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.Button</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.ButtonDefaults</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.Card</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.MaterialTheme</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.Scaffold</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.Text</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.TopAppBar</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.TopAppBarDefaults</span><br><span class="line"><span class="keyword">import</span> androidx.compose.runtime.Composable</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Alignment</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Modifier</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.graphics.Color</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.platform.LocalContext</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.unit.dp</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.unit.sp</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.NavController</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">QuickTravelScreen</span><span class="params">(navController: <span class="type">NavController</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> context = LocalContext.current</span><br><span class="line">    Scaffold(</span><br><span class="line">        topBar = &#123;</span><br><span class="line">            TopAppBar(</span><br><span class="line">                title = &#123; Text(<span class="string">&quot;快捷出行&quot;</span>) &#125;,</span><br><span class="line">                navigationIcon = &#123;</span><br><span class="line">                    Image(</span><br><span class="line">                        painter = painterResource(id = R.drawable.ic_back),</span><br><span class="line">                        contentDescription = <span class="string">&quot;Back&quot;</span>,</span><br><span class="line">                        modifier = Modifier</span><br><span class="line">                            .padding(<span class="number">8.</span>dp)</span><br><span class="line">                            .clickable &#123;</span><br><span class="line">                                navController.popBackStack()</span><br><span class="line">                            &#125;</span><br><span class="line">                    )</span><br><span class="line">                &#125;,</span><br><span class="line">                colors = TopAppBarDefaults.topAppBarColors(</span><br><span class="line">                    containerColor = MaterialTheme.colorScheme.primary</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    ) &#123; paddingValues -&gt;</span><br><span class="line">        Column(</span><br><span class="line">            modifier = Modifier</span><br><span class="line">                .fillMaxSize()</span><br><span class="line">                .background(MaterialTheme.colorScheme.background)</span><br><span class="line">                .padding(paddingValues),</span><br><span class="line">            verticalArrangement = Arrangement.spacedBy(<span class="number">16.</span>dp),</span><br><span class="line">            horizontalAlignment = Alignment.CenterHorizontally</span><br><span class="line">        ) &#123;</span><br><span class="line">            Spacer(modifier = Modifier.height(<span class="number">24.</span>dp))</span><br><span class="line">            <span class="comment">// 滴滴打车按钮</span></span><br><span class="line">            Button(</span><br><span class="line">                onClick = &#123;</span><br><span class="line">                    <span class="comment">// 调用滴滴打车 URI Scheme</span></span><br><span class="line">                    <span class="keyword">val</span> intent = Intent(Intent.ACTION_VIEW)</span><br><span class="line">                    intent.<span class="keyword">data</span> = Uri.parse(<span class="string">&quot;didi://&quot;</span>)</span><br><span class="line">                    <span class="comment">// 若滴滴未安装，跳转到商店</span></span><br><span class="line">                    <span class="keyword">if</span> (intent.resolveActivity(context.packageManager) != <span class="literal">null</span>) &#123;</span><br><span class="line">                        context.startActivity(intent)</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">val</span> uri = Uri.parse(<span class="string">&quot;market://details?id=com.xiaojukeji.didi&quot;</span>)</span><br><span class="line">                        context.startActivity(Intent(Intent.ACTION_VIEW, uri))</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                modifier = Modifier</span><br><span class="line">                    .fillMaxWidth(<span class="number">0.8f</span>)</span><br><span class="line">                    .height(<span class="number">50.</span>dp),</span><br><span class="line">                colors = ButtonDefaults.buttonColors(containerColor = MaterialTheme.colorScheme.secondary),</span><br><span class="line">                shape = RoundedCornerShape(<span class="number">25.</span>dp)</span><br><span class="line">            ) &#123;</span><br><span class="line">                Text(text = <span class="string">&quot;一键打车&quot;</span>, fontSize = <span class="number">18.</span>sp, color = Color.White)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 公交查询按钮</span></span><br><span class="line">            Button(</span><br><span class="line">                onClick = &#123;</span><br><span class="line">                    <span class="keyword">val</span> url = <span class="string">&quot;https://m.8684.cn&quot;</span></span><br><span class="line">                    <span class="keyword">val</span> intent = Intent(Intent.ACTION_VIEW, Uri.parse(url))</span><br><span class="line">                    context.startActivity(intent)</span><br><span class="line">                &#125;,</span><br><span class="line">                modifier = Modifier</span><br><span class="line">                    .fillMaxWidth(<span class="number">0.8f</span>)</span><br><span class="line">                    .height(<span class="number">50.</span>dp),</span><br><span class="line">                colors = ButtonDefaults.buttonColors(containerColor = MaterialTheme.colorScheme.secondary),</span><br><span class="line">                shape = RoundedCornerShape(<span class="number">25.</span>dp)</span><br><span class="line">            ) &#123;</span><br><span class="line">                Text(text = <span class="string">&quot;公交查询&quot;</span>, fontSize = <span class="number">18.</span>sp, color = Color.White)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="HealthScreen-kt"><a href="#HealthScreen-kt" class="headerlink" title="HealthScreen.kt"></a>HealthScreen.kt</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myelderlyapp</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.background</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.layout.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.shape.RoundedCornerShape</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.Button</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.ButtonDefaults</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.MaterialTheme</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.Scaffold</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.Text</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.TopAppBar</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.TopAppBarDefaults</span><br><span class="line"><span class="keyword">import</span> androidx.compose.runtime.Composable</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Alignment</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Modifier</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.graphics.Color</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.unit.dp</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.unit.sp</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.NavController</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">HealthScreen</span><span class="params">(navController: <span class="type">NavController</span>)</span></span> &#123;</span><br><span class="line">    Scaffold(</span><br><span class="line">        topBar = &#123;</span><br><span class="line">            TopAppBar(</span><br><span class="line">                title = &#123; Text(<span class="string">&quot;健康管理&quot;</span>) &#125;,</span><br><span class="line">                navigationIcon = &#123;</span><br><span class="line">                    Image(</span><br><span class="line">                        painter = painterResource(id = R.drawable.ic_back),</span><br><span class="line">                        contentDescription = <span class="string">&quot;Back&quot;</span>,</span><br><span class="line">                        modifier = Modifier</span><br><span class="line">                            .padding(<span class="number">8.</span>dp)</span><br><span class="line">                            .clickable &#123;</span><br><span class="line">                                navController.popBackStack()</span><br><span class="line">                            &#125;</span><br><span class="line">                    )</span><br><span class="line">                &#125;,</span><br><span class="line">                colors = TopAppBarDefaults.topAppBarColors(</span><br><span class="line">                    containerColor = MaterialTheme.colorScheme.primary</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    ) &#123; paddingValues -&gt;</span><br><span class="line">        Column(</span><br><span class="line">            modifier = Modifier</span><br><span class="line">                .fillMaxSize()</span><br><span class="line">                .background(MaterialTheme.colorScheme.background)</span><br><span class="line">                .padding(paddingValues),</span><br><span class="line">            verticalArrangement = Arrangement.spacedBy(<span class="number">16.</span>dp),</span><br><span class="line">            horizontalAlignment = Alignment.CenterHorizontally</span><br><span class="line">        ) &#123;</span><br><span class="line">            Spacer(modifier = Modifier.height(<span class="number">24.</span>dp))</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 一键挂号</span></span><br><span class="line">            Button(</span><br><span class="line">                onClick = &#123;</span><br><span class="line">                    <span class="comment">// <span class="doctag">TODO:</span> 接入挂号 API</span></span><br><span class="line">                    navController.navigate(<span class="string">&quot;register_hospital&quot;</span>)</span><br><span class="line">                &#125;,</span><br><span class="line">                modifier = Modifier</span><br><span class="line">                    .fillMaxWidth(<span class="number">0.8f</span>)</span><br><span class="line">                    .height(<span class="number">50.</span>dp),</span><br><span class="line">                colors = ButtonDefaults.buttonColors(containerColor = MaterialTheme.colorScheme.secondary),</span><br><span class="line">                shape = RoundedCornerShape(<span class="number">25.</span>dp)</span><br><span class="line">            ) &#123;</span><br><span class="line">                Text(text = <span class="string">&quot;一键挂号&quot;</span>, fontSize = <span class="number">18.</span>sp, color = Color.White)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 在线咨询</span></span><br><span class="line">            Button(</span><br><span class="line">                onClick = &#123;</span><br><span class="line">                    <span class="comment">// <span class="doctag">TODO:</span> 接入在线咨询 API</span></span><br><span class="line">                    navController.navigate(<span class="string">&quot;online_consult&quot;</span>)</span><br><span class="line">                &#125;,</span><br><span class="line">                modifier = Modifier</span><br><span class="line">                    .fillMaxWidth(<span class="number">0.8f</span>)</span><br><span class="line">                    .height(<span class="number">50.</span>dp),</span><br><span class="line">                colors = ButtonDefaults.buttonColors(containerColor = MaterialTheme.colorScheme.secondary),</span><br><span class="line">                shape = RoundedCornerShape(<span class="number">25.</span>dp)</span><br><span class="line">            ) &#123;</span><br><span class="line">                Text(text = <span class="string">&quot;在线咨询&quot;</span>, fontSize = <span class="number">18.</span>sp, color = Color.White)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 用药提醒</span></span><br><span class="line">            Button(</span><br><span class="line">                onClick = &#123;</span><br><span class="line">                    <span class="comment">// <span class="doctag">TODO:</span> 用 WorkManager 做本地定时提醒</span></span><br><span class="line">                    navController.navigate(<span class="string">&quot;medication_reminder&quot;</span>)</span><br><span class="line">                &#125;,</span><br><span class="line">                modifier = Modifier</span><br><span class="line">                    .fillMaxWidth(<span class="number">0.8f</span>)</span><br><span class="line">                    .height(<span class="number">50.</span>dp),</span><br><span class="line">                colors = ButtonDefaults.buttonColors(containerColor = MaterialTheme.colorScheme.secondary),</span><br><span class="line">                shape = RoundedCornerShape(<span class="number">25.</span>dp)</span><br><span class="line">            ) &#123;</span><br><span class="line">                Text(text = <span class="string">&quot;用药提醒&quot;</span>, fontSize = <span class="number">18.</span>sp, color = Color.White)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="ArtCommunityScreen-kt"><a href="#ArtCommunityScreen-kt" class="headerlink" title="ArtCommunityScreen.kt"></a>ArtCommunityScreen.kt</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myelderlyapp</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.Image</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.background</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.clickable</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.layout.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.lazy.grid.GridCells</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.lazy.grid.LazyVerticalGrid</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.shape.CircleShape</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.Card</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.MaterialTheme</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.Scaffold</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.Text</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.TopAppBar</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.TopAppBarDefaults</span><br><span class="line"><span class="keyword">import</span> androidx.compose.runtime.Composable</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Alignment</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Modifier</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.draw.clip</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.graphics.Color</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.res.painterResource</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.unit.dp</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.unit.sp</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.NavController</span><br><span class="line"><span class="keyword">import</span> com.airbnb.lottie.compose.*</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">ArtCommunityScreen</span><span class="params">(navController: <span class="type">NavController</span>)</span></span> &#123;</span><br><span class="line">    Scaffold(</span><br><span class="line">        topBar = &#123;</span><br><span class="line">            TopAppBar(</span><br><span class="line">                title = &#123; Text(<span class="string">&quot;文艺社区&quot;</span>) &#125;,</span><br><span class="line">                navigationIcon = &#123;</span><br><span class="line">                    Image(</span><br><span class="line">                        painter = painterResource(id = R.drawable.ic_back),</span><br><span class="line">                        contentDescription = <span class="string">&quot;Back&quot;</span>,</span><br><span class="line">                        modifier = Modifier</span><br><span class="line">                            .padding(<span class="number">8.</span>dp)</span><br><span class="line">                            .clickable &#123;</span><br><span class="line">                                navController.popBackStack()</span><br><span class="line">                            &#125;</span><br><span class="line">                    )</span><br><span class="line">                &#125;,</span><br><span class="line">                colors = TopAppBarDefaults.topAppBarColors(</span><br><span class="line">                    containerColor = MaterialTheme.colorScheme.primary</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    ) &#123; paddingValues -&gt;</span><br><span class="line">        Column(</span><br><span class="line">            modifier = Modifier</span><br><span class="line">                .fillMaxSize()</span><br><span class="line">                .background(MaterialTheme.colorScheme.background)</span><br><span class="line">                .padding(paddingValues)</span><br><span class="line">        ) &#123;</span><br><span class="line">            Spacer(modifier = Modifier.height(<span class="number">16.</span>dp))</span><br><span class="line">            LazyVerticalGrid(</span><br><span class="line">                columns = GridCells.Fixed(<span class="number">2</span>),</span><br><span class="line">                modifier = Modifier</span><br><span class="line">                    .fillMaxSize()</span><br><span class="line">                    .padding(<span class="number">16.</span>dp),</span><br><span class="line">                verticalArrangement = Arrangement.spacedBy(<span class="number">16.</span>dp),</span><br><span class="line">                horizontalArrangement = Arrangement.spacedBy(<span class="number">16.</span>dp)</span><br><span class="line">            ) &#123;</span><br><span class="line">                <span class="comment">// 五子棋</span></span><br><span class="line">                item &#123;</span><br><span class="line">                    GameCard(</span><br><span class="line">                        title = <span class="string">&quot;五子棋&quot;</span>,</span><br><span class="line">                        lottieFile = <span class="string">&quot;lottie/gomoku.json&quot;</span></span><br><span class="line">                    ) &#123;</span><br><span class="line">                        navController.navigate(<span class="string">&quot;gomoku&quot;</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 中国象棋</span></span><br><span class="line">                item &#123;</span><br><span class="line">                    GameCard(</span><br><span class="line">                        title = <span class="string">&quot;中国象棋&quot;</span>,</span><br><span class="line">                        lottieFile = <span class="string">&quot;lottie/chess.json&quot;</span></span><br><span class="line">                    ) &#123;</span><br><span class="line">                        navController.navigate(<span class="string">&quot;chess&quot;</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 围棋</span></span><br><span class="line">                item &#123;</span><br><span class="line">                    GameCard(</span><br><span class="line">                        title = <span class="string">&quot;围棋&quot;</span>,</span><br><span class="line">                        lottieFile = <span class="string">&quot;lottie/go.json&quot;</span></span><br><span class="line">                    ) &#123;</span><br><span class="line">                        navController.navigate(<span class="string">&quot;go&quot;</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 麻将</span></span><br><span class="line">                item &#123;</span><br><span class="line">                    GameCard(</span><br><span class="line">                        title = <span class="string">&quot;麻将&quot;</span>,</span><br><span class="line">                        lottieFile = <span class="string">&quot;lottie/mahjong.json&quot;</span></span><br><span class="line">                    ) &#123;</span><br><span class="line">                        navController.navigate(<span class="string">&quot;mahjong&quot;</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">GameCard</span><span class="params">(title: <span class="type">String</span>, lottieFile: <span class="type">String</span>, onClick: () -&gt; <span class="type">Unit</span>)</span></span> &#123;</span><br><span class="line">    Card(</span><br><span class="line">        modifier = Modifier</span><br><span class="line">            .size(<span class="number">150.</span>dp)</span><br><span class="line">            .clickable(onClick = onClick),</span><br><span class="line">        shape = RoundedCornerShape(<span class="number">16.</span>dp),</span><br><span class="line">        elevation = CardDefaults.cardElevation(defaultElevation = <span class="number">8.</span>dp)</span><br><span class="line">    ) &#123;</span><br><span class="line">        Box(modifier = Modifier.background(Color(<span class="number">0xFFFFF8E1</span>))) &#123;</span><br><span class="line">            <span class="keyword">val</span> composition <span class="keyword">by</span> rememberLottieComposition(LottieCompositionSpec.Asset(lottieFile))</span><br><span class="line">            <span class="keyword">val</span> progress <span class="keyword">by</span> animateLottieCompositionAsState(</span><br><span class="line">                composition,</span><br><span class="line">                iterations = LottieConstants.IterateForever</span><br><span class="line">            )</span><br><span class="line">            LottieAnimation(</span><br><span class="line">                composition,</span><br><span class="line">                progress,</span><br><span class="line">                modifier = Modifier.size(<span class="number">100.</span>dp).align(Alignment.Center)</span><br><span class="line">            )</span><br><span class="line">            Text(</span><br><span class="line">                text = title,</span><br><span class="line">                fontSize = <span class="number">16.</span>sp,</span><br><span class="line">                modifier = Modifier</span><br><span class="line">                    .align(Alignment.BottomCenter)</span><br><span class="line">                    .padding(bottom = <span class="number">8.</span>dp)</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="GomokuScreen-kt"><a href="#GomokuScreen-kt" class="headerlink" title="GomokuScreen.kt"></a>GomokuScreen.kt</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myelderlyapp</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.Canvas</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.clickable</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.layout.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.runtime.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Modifier</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.geometry.Offset</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.graphics.Color</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.input.pointer.pointerInput</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.text.font.FontWeight</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.unit.dp</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.unit.sp</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.NavController</span><br><span class="line"><span class="keyword">import</span> kotlin.random.Random</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="keyword">class</span> <span class="title class_">Point</span>(<span class="keyword">val</span> x: <span class="built_in">Int</span>, <span class="keyword">val</span> y: <span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">GomokuScreen</span><span class="params">(navController: <span class="type">NavController</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> stonePositions <span class="keyword">by</span> remember &#123; mutableStateOf(mutableListOf&lt;Pair&lt;Point, <span class="built_in">Boolean</span>&gt;&gt;()) &#125;</span><br><span class="line">    <span class="keyword">var</span> isBlackTurn <span class="keyword">by</span> remember &#123; mutableStateOf(<span class="literal">true</span>) &#125;</span><br><span class="line">    <span class="keyword">var</span> winner <span class="keyword">by</span> remember &#123; mutableStateOf&lt;String?&gt;(<span class="literal">null</span>) &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 棋局格言</span></span><br><span class="line">    <span class="keyword">val</span> proverbs = listOf(</span><br><span class="line">        <span class="string">&quot;落子无悔&quot;</span>, <span class="string">&quot;不破不立&quot;</span>, <span class="string">&quot;以退为进&quot;</span>, <span class="string">&quot;虚实相生&quot;</span>, <span class="string">&quot;厚德载物&quot;</span>,</span><br><span class="line">        <span class="string">&quot;人棋合一&quot;</span>, <span class="string">&quot;心静自然&quot;</span>, <span class="string">&quot;智者千虑，必有一失&quot;</span>, <span class="string">&quot;以逸待劳&quot;</span>, <span class="string">&quot;三思而行&quot;</span>,</span><br><span class="line">        <span class="string">&quot;见招拆招&quot;</span>, <span class="string">&quot;应对自如&quot;</span>, <span class="string">&quot;十步杀一人，千里不留行&quot;</span>, <span class="string">&quot;先声夺人&quot;</span>, <span class="string">&quot;不攻自破&quot;</span>,</span><br><span class="line">        <span class="string">&quot;沉着冷静&quot;</span>, <span class="string">&quot;博观约取&quot;</span>, <span class="string">&quot;胜兵先胜而后求战&quot;</span>, <span class="string">&quot;知彼知己，百战不殆&quot;</span>, <span class="string">&quot;兵贵神速&quot;</span>,</span><br><span class="line">        <span class="string">&quot;看山是山，看山不是山&quot;</span>, <span class="string">&quot;舍我其谁&quot;</span>, <span class="string">&quot;对弈如人生&quot;</span>, <span class="string">&quot;手谈普世&quot;</span>, <span class="string">&quot;一子当先&quot;</span>,</span><br><span class="line">        <span class="string">&quot;黑白分明&quot;</span>, <span class="string">&quot;虚晃一招&quot;</span>, <span class="string">&quot;转守为攻&quot;</span>, <span class="string">&quot;明修栈道，暗度陈仓&quot;</span>, <span class="string">&quot;顺势而为&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">val</span> currentProverb = remember &#123; proverbs.random() &#125;</span><br><span class="line"></span><br><span class="line">    Column(</span><br><span class="line">        modifier = Modifier.fillMaxSize(),</span><br><span class="line">        verticalArrangement = Arrangement.Top,</span><br><span class="line">        horizontalAlignment = Alignment.CenterHorizontally</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="comment">// 标题与格言</span></span><br><span class="line">        Text(</span><br><span class="line">            text = <span class="string">&quot;五子棋&quot;</span>,</span><br><span class="line">            fontSize = <span class="number">24.</span>sp,</span><br><span class="line">            fontWeight = FontWeight.Bold,</span><br><span class="line">            modifier = Modifier.padding(top = <span class="number">16.</span>dp)</span><br><span class="line">        )</span><br><span class="line">        Text(</span><br><span class="line">            text = <span class="string">&quot;格言：<span class="variable">$currentProverb</span>&quot;</span>,</span><br><span class="line">            fontSize = <span class="number">16.</span>sp,</span><br><span class="line">            modifier = Modifier.padding(vertical = <span class="number">8.</span>dp)</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">if</span> (winner != <span class="literal">null</span>) &#123;</span><br><span class="line">            Text(</span><br><span class="line">                text = <span class="string">&quot;<span class="variable">$winner</span> 获胜！&quot;</span>,</span><br><span class="line">                fontSize = <span class="number">20.</span>sp,</span><br><span class="line">                fontWeight = FontWeight.Bold,</span><br><span class="line">                color = <span class="keyword">if</span> (winner == <span class="string">&quot;黑方&quot;</span>) Color.Black <span class="keyword">else</span> Color.White,</span><br><span class="line">                modifier = Modifier.padding(vertical = <span class="number">4.</span>dp)</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">        Box(</span><br><span class="line">            modifier = Modifier</span><br><span class="line">                .padding(<span class="number">16.</span>dp)</span><br><span class="line">                .size(<span class="number">300.</span>dp)</span><br><span class="line">                .background(Color(<span class="number">0xFFEECC99</span>))</span><br><span class="line">                .pointerInput(<span class="built_in">Unit</span>) &#123;</span><br><span class="line">                    detectTapGestures &#123; offset -&gt;</span><br><span class="line">                        <span class="keyword">if</span> (winner != <span class="literal">null</span>) <span class="keyword">return</span><span class="symbol">@detectTapGestures</span></span><br><span class="line">                        <span class="keyword">val</span> cellSize = <span class="number">300f</span> / <span class="number">15f</span></span><br><span class="line">                        <span class="keyword">val</span> x = (offset.x / cellSize).toInt()</span><br><span class="line">                        <span class="keyword">val</span> y = (offset.y / cellSize).toInt()</span><br><span class="line">                        <span class="keyword">val</span> point = Point(x, y)</span><br><span class="line">                        <span class="comment">// 已有棋子则不可落子</span></span><br><span class="line">                        <span class="keyword">if</span> (stonePositions.any &#123; it.first == point &#125;) <span class="keyword">return</span><span class="symbol">@detectTapGestures</span></span><br><span class="line">                        stonePositions.add(point to isBlackTurn)</span><br><span class="line">                        <span class="keyword">if</span> (checkWin(stonePositions, point, isBlackTurn)) &#123;</span><br><span class="line">                            winner = <span class="keyword">if</span> (isBlackTurn) <span class="string">&quot;黑方&quot;</span> <span class="keyword">else</span> <span class="string">&quot;白方&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        isBlackTurn = !isBlackTurn</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        ) &#123;</span><br><span class="line">            Canvas(modifier = Modifier.matchParentSize()) &#123;</span><br><span class="line">                <span class="keyword">val</span> cellSize = size.width / <span class="number">15f</span></span><br><span class="line">                <span class="comment">// 绘制棋盘</span></span><br><span class="line">                <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">0.</span><span class="number">.15</span>) &#123;</span><br><span class="line">                    drawLine(</span><br><span class="line">                        color = Color.Black,</span><br><span class="line">                        start = Offset(i * cellSize, <span class="number">0f</span>),</span><br><span class="line">                        end = Offset(i * cellSize, size.height)</span><br><span class="line">                    )</span><br><span class="line">                    drawLine(</span><br><span class="line">                        color = Color.Black,</span><br><span class="line">                        start = Offset(<span class="number">0f</span>, i * cellSize),</span><br><span class="line">                        end = Offset(size.width, i * cellSize)</span><br><span class="line">                    )</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 绘制棋子</span></span><br><span class="line">                stonePositions.forEach &#123; (pt, isBlack) -&gt;</span><br><span class="line">                    drawCircle(</span><br><span class="line">                        color = <span class="keyword">if</span> (isBlack) Color.Black <span class="keyword">else</span> Color.White,</span><br><span class="line">                        radius = cellSize * <span class="number">0.4f</span>,</span><br><span class="line">                        center = Offset(pt.x * cellSize + cellSize / <span class="number">2</span>, pt.y * cellSize + cellSize / <span class="number">2</span>)</span><br><span class="line">                    )</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Spacer(modifier = Modifier.height(<span class="number">16.</span>dp))</span><br><span class="line">        Button(</span><br><span class="line">            onClick = &#123;</span><br><span class="line">                stonePositions.clear()</span><br><span class="line">                isBlackTurn = <span class="literal">true</span></span><br><span class="line">                winner = <span class="literal">null</span></span><br><span class="line">            &#125;,</span><br><span class="line">            modifier = Modifier</span><br><span class="line">                .fillMaxWidth(<span class="number">0.5f</span>)</span><br><span class="line">                .height(<span class="number">40.</span>dp),</span><br><span class="line">            shape = RoundedCornerShape(<span class="number">20.</span>dp),</span><br><span class="line">            colors = ButtonDefaults.buttonColors(containerColor = MaterialTheme.colorScheme.primary)</span><br><span class="line">        ) &#123;</span><br><span class="line">            Text(text = <span class="string">&quot;重新开始&quot;</span>, color = Color.White)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Spacer(modifier = Modifier.height(<span class="number">16.</span>dp))</span><br><span class="line">        Text(</span><br><span class="line">            text = <span class="string">&quot;点击屏幕任意位置落子。先黑后白，连成五子为胜。&quot;</span>,</span><br><span class="line">            fontSize = <span class="number">14.</span>sp</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">checkWin</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    positions: <span class="type">List</span>&lt;<span class="type">Pair</span>&lt;<span class="type">Point</span>, <span class="built_in">Boolean</span>&gt;&gt;,</span></span></span><br><span class="line"><span class="params"><span class="function">    lastMove: <span class="type">Point</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    isBlack: <span class="type">Boolean</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">    <span class="keyword">val</span> directions = listOf(</span><br><span class="line">        listOf(Pair(<span class="number">1</span>, <span class="number">0</span>), Pair(-<span class="number">1</span>, <span class="number">0</span>)), <span class="comment">// 横向</span></span><br><span class="line">        listOf(Pair(<span class="number">0</span>, <span class="number">1</span>), Pair(<span class="number">0</span>, -<span class="number">1</span>)), <span class="comment">// 纵向</span></span><br><span class="line">        listOf(Pair(<span class="number">1</span>, <span class="number">1</span>), Pair(-<span class="number">1</span>, -<span class="number">1</span>)), <span class="comment">// 斜向1</span></span><br><span class="line">        listOf(Pair(<span class="number">1</span>, -<span class="number">1</span>), Pair(-<span class="number">1</span>, <span class="number">1</span>)) <span class="comment">// 斜向2</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">for</span> (dir <span class="keyword">in</span> directions) &#123;</span><br><span class="line">        <span class="keyword">var</span> count = <span class="number">1</span></span><br><span class="line">        dir.forEach &#123; (dx, dy) -&gt;</span><br><span class="line">            <span class="keyword">var</span> nx = lastMove.x + dx</span><br><span class="line">            <span class="keyword">var</span> ny = lastMove.y + dy</span><br><span class="line">            <span class="keyword">while</span> (positions.any &#123; it.first.x == nx &amp;&amp; it.first.y == ny &amp;&amp; it.second == isBlack &#125;) &#123;</span><br><span class="line">                count++</span><br><span class="line">                nx += dx</span><br><span class="line">                ny += dy</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (count &gt;= <span class="number">5</span>) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="ChessScreen-kt"><a href="#ChessScreen-kt" class="headerlink" title="ChessScreen.kt"></a>ChessScreen.kt</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myelderlyapp</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.graphics.*</span><br><span class="line"><span class="keyword">import</span> android.util.AttributeSet</span><br><span class="line"><span class="keyword">import</span> android.view.MotionEvent</span><br><span class="line"><span class="keyword">import</span> android.view.View</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.layout.Box</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.layout.fillMaxSize</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.runtime.Composable</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Modifier</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.platform.LocalContext</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.NavController</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义 View：绘制中国象棋棋盘及棋子，并实现简单的交互</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ChessBoardView</span>(context: Context, attrs: AttributeSet? = <span class="literal">null</span>) : View(context, attrs) &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> paint = Paint().apply &#123;</span><br><span class="line">        isAntiAlias = <span class="literal">true</span></span><br><span class="line">        strokeWidth = <span class="number">4f</span></span><br><span class="line">        color = Color.BLACK</span><br><span class="line">        style = Paint.Style.STROKE</span><br><span class="line">        textSize = <span class="number">40f</span></span><br><span class="line">        textAlign = Paint.Align.CENTER</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> gridSize = <span class="number">9</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> totalRows = <span class="number">10</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> cellSize <span class="keyword">get</span>() = width / gridSize.toFloat()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> initialPositions: MutableMap&lt;Pair&lt;<span class="built_in">Int</span>, <span class="built_in">Int</span>&gt;, String&gt; = mutableMapOf()</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> currentPositions: MutableMap&lt;Pair&lt;<span class="built_in">Int</span>, <span class="built_in">Int</span>&gt;, String&gt; = mutableMapOf()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span> &#123;</span><br><span class="line">        <span class="comment">// 初始化棋子位置（仅部分示例，完整阵型需自行补充）</span></span><br><span class="line">        initialPositions[Pair(<span class="number">4</span>, <span class="number">0</span>)] = <span class="string">&quot;将&quot;</span></span><br><span class="line">        initialPositions[Pair(<span class="number">4</span>, <span class="number">9</span>)] = <span class="string">&quot;帅&quot;</span></span><br><span class="line">        initialPositions[Pair(<span class="number">0</span>, <span class="number">0</span>)] = <span class="string">&quot;车&quot;</span></span><br><span class="line">        initialPositions[Pair(<span class="number">8</span>, <span class="number">0</span>)] = <span class="string">&quot;车&quot;</span></span><br><span class="line">        initialPositions[Pair(<span class="number">0</span>, <span class="number">9</span>)] = <span class="string">&quot;车&quot;</span></span><br><span class="line">        initialPositions[Pair(<span class="number">8</span>, <span class="number">9</span>)] = <span class="string">&quot;车&quot;</span></span><br><span class="line">        <span class="comment">// …其余棋子位置信息…</span></span><br><span class="line">        currentPositions.putAll(initialPositions)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onDraw</span><span class="params">(canvas: <span class="type">Canvas</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onDraw(canvas)</span><br><span class="line">        <span class="comment">// 画棋盘线</span></span><br><span class="line">        <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">0.</span>.gridSize) &#123;</span><br><span class="line">            canvas.drawLine(i * cellSize, <span class="number">0f</span>, i * cellSize, totalRows * cellSize, paint)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (j <span class="keyword">in</span> <span class="number">0.</span>.totalRows) &#123;</span><br><span class="line">            canvas.drawLine(<span class="number">0f</span>, j * cellSize, gridSize * cellSize, j * cellSize, paint)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 楚河汉界文字</span></span><br><span class="line">        canvas.drawText(</span><br><span class="line">            <span class="string">&quot;楚 河&quot;</span>,</span><br><span class="line">            <span class="number">2</span> * cellSize,</span><br><span class="line">            <span class="number">5</span> * cellSize - cellSize / <span class="number">4</span>,</span><br><span class="line">            paint</span><br><span class="line">        )</span><br><span class="line">        canvas.drawText(</span><br><span class="line">            <span class="string">&quot;汉 界&quot;</span>,</span><br><span class="line">            <span class="number">6</span> * cellSize,</span><br><span class="line">            <span class="number">5</span> * cellSize - cellSize / <span class="number">4</span>,</span><br><span class="line">            paint</span><br><span class="line">        )</span><br><span class="line">        <span class="comment">// 绘制棋子</span></span><br><span class="line">        currentPositions.forEach &#123; (pos, label) -&gt;</span><br><span class="line">            <span class="keyword">val</span> cx = pos.first * cellSize + cellSize / <span class="number">2</span></span><br><span class="line">            <span class="keyword">val</span> cy = pos.second * cellSize + cellSize / <span class="number">2</span></span><br><span class="line">            paint.style = Paint.Style.FILL</span><br><span class="line">            paint.color = <span class="keyword">if</span> (pos.second &lt; <span class="number">5</span>) Color.RED <span class="keyword">else</span> Color.BLACK</span><br><span class="line">            canvas.drawCircle(cx, cy, cellSize * <span class="number">0.4f</span>, paint)</span><br><span class="line">            paint.color = Color.WHITE</span><br><span class="line">            canvas.drawText(label, cx, cy + paint.textSize / <span class="number">4</span>, paint)</span><br><span class="line">            paint.style = Paint.Style.STROKE</span><br><span class="line">            paint.color = Color.BLACK</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onTouchEvent</span><span class="params">(event: <span class="type">MotionEvent</span>)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (event.action == MotionEvent.ACTION_DOWN) &#123;</span><br><span class="line">            <span class="keyword">val</span> col = (event.x / cellSize).toInt()</span><br><span class="line">            <span class="keyword">val</span> row = (event.y / cellSize).toInt()</span><br><span class="line">            <span class="comment">// 点击棋子后暂不实现移动，只打印坐标示例</span></span><br><span class="line">            <span class="keyword">if</span> (currentPositions.containsKey(Pair(col, row))) &#123;</span><br><span class="line">                <span class="comment">// <span class="doctag">TODO:</span> 实现棋子选中与移动逻辑</span></span><br><span class="line">                println(<span class="string">&quot;点击了棋子：(<span class="variable">$col</span>, <span class="variable">$row</span>)  <span class="subst">$&#123;currentPositions[Pair(col, row)]&#125;</span>&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">ChessScreen</span><span class="params">(navController: <span class="type">NavController</span>)</span></span> &#123;</span><br><span class="line">    Scaffold(</span><br><span class="line">        topBar = &#123;</span><br><span class="line">            TopAppBar(</span><br><span class="line">                title = &#123; Text(<span class="string">&quot;中国象棋&quot;</span>) &#125;,</span><br><span class="line">                navigationIcon = &#123;</span><br><span class="line">                    Image(</span><br><span class="line">                        painter = painterResource(id = R.drawable.ic_back),</span><br><span class="line">                        contentDescription = <span class="string">&quot;Back&quot;</span>,</span><br><span class="line">                        modifier = Modifier</span><br><span class="line">                            .padding(<span class="number">8.</span>dp)</span><br><span class="line">                            .clickable &#123; navController.popBackStack() &#125;</span><br><span class="line">                    )</span><br><span class="line">                &#125;,</span><br><span class="line">                colors = TopAppBarDefaults.topAppBarColors(</span><br><span class="line">                    containerColor = MaterialTheme.colorScheme.primary</span><br><span class="line">                ),</span><br><span class="line">                actions = &#123;</span><br><span class="line">                    TextButton(onClick = &#123; <span class="comment">/* 重置逻辑，可清空 currentPositions 并 restore initialPositions */</span> &#125;) &#123;</span><br><span class="line">                        Text(<span class="string">&quot;重置&quot;</span>, color = Color.White)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    ) &#123; paddingValues -&gt;</span><br><span class="line">        Box(modifier = Modifier.fillMaxSize()) &#123;</span><br><span class="line">            AndroidView(</span><br><span class="line">                factory = &#123; context -&gt; ChessBoardView(context) &#125;,</span><br><span class="line">                modifier = Modifier.fillMaxSize()</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="GoGameScreen-kt"><a href="#GoGameScreen-kt" class="headerlink" title="GoGameScreen.kt"></a>GoGameScreen.kt</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myelderlyapp</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.Canvas</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.clickable</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.layout.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.runtime.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Modifier</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.geometry.Offset</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.graphics.Color</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.input.pointer.pointerInput</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.unit.dp</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.unit.sp</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.NavController</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="keyword">class</span> <span class="title class_">GoPoint</span>(<span class="keyword">val</span> x: <span class="built_in">Int</span>, <span class="keyword">val</span> y: <span class="built_in">Int</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">GoGameScreen</span><span class="params">(navController: <span class="type">NavController</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> stonePositions <span class="keyword">by</span> remember &#123; mutableStateOf(mutableListOf&lt;Pair&lt;GoPoint, <span class="built_in">Boolean</span>&gt;&gt;()) &#125;</span><br><span class="line">    <span class="keyword">var</span> isBlackTurn <span class="keyword">by</span> remember &#123; mutableStateOf(<span class="literal">true</span>) &#125;</span><br><span class="line">    <span class="keyword">var</span> koPoint <span class="keyword">by</span> remember &#123; mutableStateOf&lt;GoPoint?&gt;(<span class="literal">null</span>) &#125;</span><br><span class="line">    <span class="keyword">var</span> winner <span class="keyword">by</span> remember &#123; mutableStateOf&lt;String?&gt;(<span class="literal">null</span>) &#125;</span><br><span class="line">    <span class="keyword">val</span> moveHistory = remember &#123; mutableStateListOf&lt;Pair&lt;GoPoint, <span class="built_in">Boolean</span>&gt;&gt;() &#125;</span><br><span class="line"></span><br><span class="line">    Column(</span><br><span class="line">        modifier = Modifier.fillMaxSize(),</span><br><span class="line">        verticalArrangement = Arrangement.Top,</span><br><span class="line">        horizontalAlignment = Alignment.CenterHorizontally</span><br><span class="line">    ) &#123;</span><br><span class="line">        Text(</span><br><span class="line">            text = <span class="string">&quot;围棋&quot;</span>,</span><br><span class="line">            fontSize = <span class="number">24.</span>sp,</span><br><span class="line">            modifier = Modifier.padding(vertical = <span class="number">16.</span>dp)</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">if</span> (winner != <span class="literal">null</span>) &#123;</span><br><span class="line">            Text(</span><br><span class="line">                text = <span class="string">&quot;<span class="variable">$winner</span> 获胜！&quot;</span>,</span><br><span class="line">                fontSize = <span class="number">20.</span>sp,</span><br><span class="line">                color = <span class="keyword">if</span> (winner == <span class="string">&quot;黑方&quot;</span>) Color.Black <span class="keyword">else</span> Color.White,</span><br><span class="line">                modifier = Modifier.padding(vertical = <span class="number">4.</span>dp)</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">        Box(</span><br><span class="line">            modifier = Modifier</span><br><span class="line">                .padding(<span class="number">16.</span>dp)</span><br><span class="line">                .size(<span class="number">340.</span>dp)</span><br><span class="line">                .background(Color(<span class="number">0xFFF0D9B5</span>))</span><br><span class="line">                .pointerInput(<span class="built_in">Unit</span>) &#123;</span><br><span class="line">                    detectTapGestures &#123; offset -&gt;</span><br><span class="line">                        <span class="keyword">if</span> (winner != <span class="literal">null</span>) <span class="keyword">return</span><span class="symbol">@detectTapGestures</span></span><br><span class="line">                        <span class="keyword">val</span> cellSize = <span class="number">340f</span> / <span class="number">19f</span></span><br><span class="line">                        <span class="keyword">val</span> x = (offset.x / cellSize).toInt()</span><br><span class="line">                        <span class="keyword">val</span> y = (offset.y / cellSize).toInt()</span><br><span class="line">                        <span class="keyword">val</span> point = GoPoint(x, y)</span><br><span class="line">                        <span class="comment">// 落子位置合法性：无子且不与 KO 点冲突</span></span><br><span class="line">                        <span class="keyword">if</span> (stonePositions.any &#123; it.first == point &#125; || (koPoint != <span class="literal">null</span> &amp;&amp; point == koPoint)) <span class="keyword">return</span><span class="symbol">@detectTapGestures</span></span><br><span class="line">                        stonePositions.add(point to isBlackTurn)</span><br><span class="line">                        moveHistory.add(point to isBlackTurn)</span><br><span class="line">                        <span class="comment">// 简易提子 &amp; KO 判定略去，仅演示</span></span><br><span class="line">                        isBlackTurn = !isBlackTurn</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        ) &#123;</span><br><span class="line">            Canvas(modifier = Modifier.matchParentSize()) &#123;</span><br><span class="line">                <span class="keyword">val</span> cellSize = size.width / <span class="number">19f</span></span><br><span class="line">                <span class="comment">// 绘制棋盘网格</span></span><br><span class="line">                <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">0.</span><span class="number">.18</span>) &#123;</span><br><span class="line">                    drawLine(</span><br><span class="line">                        color = Color.Black,</span><br><span class="line">                        start = Offset(i * cellSize, <span class="number">0f</span>),</span><br><span class="line">                        end = Offset(i * cellSize, size.height)</span><br><span class="line">                    )</span><br><span class="line">                    drawLine(</span><br><span class="line">                        color = Color.Black,</span><br><span class="line">                        start = Offset(<span class="number">0f</span>, i * cellSize),</span><br><span class="line">                        end = Offset(size.width, i * cellSize)</span><br><span class="line">                    )</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 星位（九个星点）</span></span><br><span class="line">                <span class="keyword">val</span> stars = listOf(<span class="number">3</span>, <span class="number">9</span>, <span class="number">15</span>)</span><br><span class="line">                stars.forEach &#123; sx -&gt;</span><br><span class="line">                    stars.forEach &#123; sy -&gt;</span><br><span class="line">                        drawCircle(</span><br><span class="line">                            color = Color.Black,</span><br><span class="line">                            radius = <span class="number">5f</span>,</span><br><span class="line">                            center = Offset(sx * cellSize, sy * cellSize)</span><br><span class="line">                        )</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 绘制棋子</span></span><br><span class="line">                stonePositions.forEach &#123; (pt, isBlack) -&gt;</span><br><span class="line">                    drawCircle(</span><br><span class="line">                        color = <span class="keyword">if</span> (isBlack) Color.Black <span class="keyword">else</span> Color.White,</span><br><span class="line">                        radius = cellSize * <span class="number">0.45f</span>,</span><br><span class="line">                        center = Offset(pt.x * cellSize, pt.y * cellSize)</span><br><span class="line">                    )</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Spacer(modifier = Modifier.height(<span class="number">16.</span>dp))</span><br><span class="line">        Row(horizontalArrangement = Arrangement.spacedBy(<span class="number">16.</span>dp)) &#123;</span><br><span class="line">            Button(onClick = &#123;</span><br><span class="line">                <span class="comment">// 悔棋：移除最后一步</span></span><br><span class="line">                <span class="keyword">if</span> (moveHistory.isNotEmpty()) &#123;</span><br><span class="line">                    <span class="keyword">val</span> last = moveHistory.removeAt(moveHistory.size - <span class="number">1</span>)</span><br><span class="line">                    stonePositions.remove(last)</span><br><span class="line">                    isBlackTurn = last.second</span><br><span class="line">                    <span class="comment">// 简易 KO 恢复略去</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;) &#123;</span><br><span class="line">                Text(<span class="string">&quot;悔棋&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            Button(onClick = &#123;</span><br><span class="line">                <span class="comment">// 重置棋局</span></span><br><span class="line">                stonePositions.clear()</span><br><span class="line">                moveHistory.clear()</span><br><span class="line">                isBlackTurn = <span class="literal">true</span></span><br><span class="line">                winner = <span class="literal">null</span></span><br><span class="line">                koPoint = <span class="literal">null</span></span><br><span class="line">            &#125;) &#123;</span><br><span class="line">                Text(<span class="string">&quot;重新开始&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Spacer(modifier = Modifier.height(<span class="number">16.</span>dp))</span><br><span class="line">        Text(text = <span class="string">&quot;点击星点附近落子。先黑后白。简单 Ko 劫判定。&quot;</span>, fontSize = <span class="number">14.</span>sp)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="MahjongScreen-kt"><a href="#MahjongScreen-kt" class="headerlink" title="MahjongScreen.kt"></a>MahjongScreen.kt</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myelderlyapp</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Activity</span><br><span class="line"><span class="keyword">import</span> android.content.pm.ActivityInfo</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.Canvas</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.background</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.clickable</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.layout.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.shape.RoundedCornerShape</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material3.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.runtime.*</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Alignment</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Modifier</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.graphics.Color</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.platform.LocalView</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.text.font.FontWeight</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.unit.dp</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.unit.sp</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.NavController</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="keyword">class</span> <span class="title class_">Tile</span>(<span class="keyword">val</span> emoji: String)</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">MahjongScreen</span><span class="params">(navController: <span class="type">NavController</span>)</span></span> &#123;</span><br><span class="line">    <span class="comment">// 强制横屏</span></span><br><span class="line">    DisposableEffect(<span class="built_in">Unit</span>) &#123;</span><br><span class="line">        <span class="keyword">val</span> activity = (LocalView.current.context <span class="keyword">as</span> Activity)</span><br><span class="line">        activity.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE</span><br><span class="line">        onDispose &#123; activity.requestedOrientation = ActivityInfo.SCREEN_ORIENTATION_SENSOR &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 模拟四家手牌</span></span><br><span class="line">    <span class="keyword">val</span> bottomHand = remember &#123; mutableStateListOf&lt;Tile&gt;() &#125;</span><br><span class="line">    <span class="keyword">val</span> topHand = remember &#123; mutableStateListOf&lt;Tile&gt;() &#125;</span><br><span class="line">    <span class="keyword">val</span> leftHand = remember &#123; mutableStateListOf&lt;Tile&gt;() &#125;</span><br><span class="line">    <span class="keyword">val</span> rightHand = remember &#123; mutableStateListOf&lt;Tile&gt;() &#125;</span><br><span class="line">    <span class="keyword">val</span> centerDiscard = remember &#123; mutableStateListOf&lt;Tile&gt;() &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化——这里只放少量示例牌</span></span><br><span class="line">    LaunchedEffect(<span class="built_in">Unit</span>) &#123;</span><br><span class="line">        bottomHand.addAll(listOf(Tile(<span class="string">&quot;🀇&quot;</span>), Tile(<span class="string">&quot;🀈&quot;</span>), Tile(<span class="string">&quot;🀉&quot;</span>), Tile(<span class="string">&quot;🀊&quot;</span>), Tile(<span class="string">&quot;🀋&quot;</span>)))</span><br><span class="line">        topHand.addAll(listOf(Tile(<span class="string">&quot;🀇&quot;</span>), Tile(<span class="string">&quot;🀈&quot;</span>), Tile(<span class="string">&quot;🀉&quot;</span>), Tile(<span class="string">&quot;🀊&quot;</span>), Tile(<span class="string">&quot;🀋&quot;</span>)))</span><br><span class="line">        leftHand.addAll(listOf(Tile(<span class="string">&quot;🀇&quot;</span>), Tile(<span class="string">&quot;🀈&quot;</span>), Tile(<span class="string">&quot;🀉&quot;</span>), Tile(<span class="string">&quot;🀊&quot;</span>), Tile(<span class="string">&quot;🀋&quot;</span>)))</span><br><span class="line">        rightHand.addAll(listOf(Tile(<span class="string">&quot;🀇&quot;</span>), Tile(<span class="string">&quot;🀈&quot;</span>), Tile(<span class="string">&quot;🀉&quot;</span>), Tile(<span class="string">&quot;🀊&quot;</span>), Tile(<span class="string">&quot;🀋&quot;</span>)))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Column(</span><br><span class="line">        modifier = Modifier</span><br><span class="line">            .fillMaxSize()</span><br><span class="line">            .background(Color(<span class="number">0xFF00704A</span>))</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="comment">// 顶部：上家手牌（倒置）</span></span><br><span class="line">        Row(</span><br><span class="line">            modifier = Modifier</span><br><span class="line">                .fillMaxWidth()</span><br><span class="line">                .height(<span class="number">60.</span>dp),</span><br><span class="line">            horizontalArrangement = Arrangement.Center,</span><br><span class="line">            verticalAlignment = Alignment.CenterVertically</span><br><span class="line">        ) &#123;</span><br><span class="line">            topHand.reversed().forEach &#123; tile -&gt;</span><br><span class="line">                Text(</span><br><span class="line">                    text = <span class="string">&quot;🀫&quot;</span>, <span class="comment">// 牌背，倒置显示</span></span><br><span class="line">                    fontSize = <span class="number">24.</span>sp,</span><br><span class="line">                    modifier = Modifier.padding(horizontal = <span class="number">4.</span>dp)</span><br><span class="line">                )</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 中央：左家手牌 + 出牌区 + 右家手牌</span></span><br><span class="line">        Row(</span><br><span class="line">            modifier = Modifier</span><br><span class="line">                .fillMaxWidth()</span><br><span class="line">                .weight(<span class="number">1f</span>),</span><br><span class="line">            verticalAlignment = Alignment.CenterVertically</span><br><span class="line">        ) &#123;</span><br><span class="line">            <span class="comment">// 左家手牌（竖排）</span></span><br><span class="line">            Column(</span><br><span class="line">                modifier = Modifier</span><br><span class="line">                    .width(<span class="number">40.</span>dp)</span><br><span class="line">                    .fillMaxHeight(),</span><br><span class="line">                verticalArrangement = Arrangement.SpaceEvenly,</span><br><span class="line">                horizontalAlignment = Alignment.CenterHorizontally</span><br><span class="line">            ) &#123;</span><br><span class="line">                leftHand.forEach &#123; tile -&gt;</span><br><span class="line">                    Text(text = <span class="string">&quot;🀫&quot;</span>, fontSize = <span class="number">24.</span>sp)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 出牌区</span></span><br><span class="line">            Box(</span><br><span class="line">                modifier = Modifier</span><br><span class="line">                    .weight(<span class="number">1f</span>)</span><br><span class="line">                    .fillMaxHeight()</span><br><span class="line">                    .background(Color(<span class="number">0xFF004D3B</span>)),</span><br><span class="line">                contentAlignment = Alignment.Center</span><br><span class="line">            ) &#123;</span><br><span class="line">                <span class="keyword">if</span> (centerDiscard.isEmpty()) &#123;</span><br><span class="line">                    Text(text = <span class="string">&quot;等待出牌&quot;</span>, fontSize = <span class="number">20.</span>sp, color = Color.White)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Text(text = centerDiscard.last().emoji, fontSize = <span class="number">32.</span>sp)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 右家手牌（竖排，倒置显示）</span></span><br><span class="line">            Column(</span><br><span class="line">                modifier = Modifier</span><br><span class="line">                    .width(<span class="number">40.</span>dp)</span><br><span class="line">                    .fillMaxHeight(),</span><br><span class="line">                verticalArrangement = Arrangement.SpaceEvenly,</span><br><span class="line">                horizontalAlignment = Alignment.CenterHorizontally</span><br><span class="line">            ) &#123;</span><br><span class="line">                rightHand.reversed().forEach &#123; tile -&gt;</span><br><span class="line">                    Text(text = <span class="string">&quot;🀫&quot;</span>, fontSize = <span class="number">24.</span>sp)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 底部：玩家手牌 + 操作按钮</span></span><br><span class="line">        Column(</span><br><span class="line">            modifier = Modifier</span><br><span class="line">                .fillMaxWidth()</span><br><span class="line">                .height(<span class="number">120.</span>dp)</span><br><span class="line">                .background(Color(<span class="number">0xFF004D3B</span>))</span><br><span class="line">                .padding(<span class="number">8.</span>dp),</span><br><span class="line">            verticalArrangement = Arrangement.SpaceBetween</span><br><span class="line">        ) &#123;</span><br><span class="line">            <span class="comment">// 玩家手牌</span></span><br><span class="line">            Row(</span><br><span class="line">                modifier = Modifier</span><br><span class="line">                    .fillMaxWidth()</span><br><span class="line">                    .height(<span class="number">60.</span>dp),</span><br><span class="line">                horizontalArrangement = Arrangement.Center,</span><br><span class="line">                verticalAlignment = Alignment.CenterVertically</span><br><span class="line">            ) &#123;</span><br><span class="line">                bottomHand.forEach &#123; tile -&gt;</span><br><span class="line">                    Text(</span><br><span class="line">                        text = tile.emoji,</span><br><span class="line">                        fontSize = <span class="number">32.</span>sp,</span><br><span class="line">                        modifier = Modifier.padding(horizontal = <span class="number">4.</span>dp)</span><br><span class="line">                    )</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 操作按钮</span></span><br><span class="line">            Row(</span><br><span class="line">                modifier = Modifier</span><br><span class="line">                    .fillMaxWidth()</span><br><span class="line">                    .height(<span class="number">40.</span>dp),</span><br><span class="line">                horizontalArrangement = Arrangement.SpaceEvenly,</span><br><span class="line">                verticalAlignment = Alignment.CenterVertically</span><br><span class="line">            ) &#123;</span><br><span class="line">                Button(</span><br><span class="line">                    onClick = &#123;</span><br><span class="line">                        <span class="comment">// 碰示例：将玩家最后一张牌出到弃牌区</span></span><br><span class="line">                        <span class="keyword">if</span> (bottomHand.isNotEmpty()) &#123;</span><br><span class="line">                            <span class="keyword">val</span> tile = bottomHand.removeLast()</span><br><span class="line">                            centerDiscard.add(tile)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    colors = ButtonDefaults.buttonColors(containerColor = MaterialTheme.colorScheme.secondary),</span><br><span class="line">                    shape = RoundedCornerShape(<span class="number">20.</span>dp),</span><br><span class="line">                    modifier = Modifier.weight(<span class="number">1f</span>)</span><br><span class="line">                ) &#123;</span><br><span class="line">                    Text(<span class="string">&quot;碰&quot;</span>, color = Color.White)</span><br><span class="line">                &#125;</span><br><span class="line">                Button(</span><br><span class="line">                    onClick = &#123;</span><br><span class="line">                        <span class="comment">// 杠示例</span></span><br><span class="line">                        <span class="keyword">if</span> (bottomHand.isNotEmpty()) &#123;</span><br><span class="line">                            <span class="keyword">val</span> tile = bottomHand.removeLast()</span><br><span class="line">                            centerDiscard.add(tile)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    colors = ButtonDefaults.buttonColors(containerColor = MaterialTheme.colorScheme.secondary),</span><br><span class="line">                    shape = RoundedCornerShape(<span class="number">20.</span>dp),</span><br><span class="line">                    modifier = Modifier.weight(<span class="number">1f</span>)</span><br><span class="line">                ) &#123;</span><br><span class="line">                    Text(<span class="string">&quot;杠&quot;</span>, color = Color.White)</span><br><span class="line">                &#125;</span><br><span class="line">                Button(</span><br><span class="line">                    onClick = &#123;</span><br><span class="line">                        <span class="comment">// 胡示例</span></span><br><span class="line">                        <span class="keyword">if</span> (bottomHand.isNotEmpty()) &#123;</span><br><span class="line">                            <span class="keyword">val</span> tile = bottomHand.removeLast()</span><br><span class="line">                            centerDiscard.add(tile)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    colors = ButtonDefaults.buttonColors(containerColor = MaterialTheme.colorScheme.secondary),</span><br><span class="line">                    shape = RoundedCornerShape(<span class="number">20.</span>dp),</span><br><span class="line">                    modifier = Modifier.weight(<span class="number">1f</span>)</span><br><span class="line">                ) &#123;</span><br><span class="line">                    Text(<span class="string">&quot;胡&quot;</span>, color = Color.White)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="可改进与未来展望"><a href="#可改进与未来展望" class="headerlink" title="可改进与未来展望"></a>可改进与未来展望</h2><ol>
<li><p><strong>数据持久化</strong></p>
<ul>
<li>当前所有游戏与用户操作均为内存状态，应用重启后会丢失。</li>
<li>后续可引入 <strong>Room Database</strong>，将用户对局、健康记录、用药提醒等持久化到本地。</li>
</ul>
</li>
<li><p><strong>AI 对弈</strong></p>
<ul>
<li>为五子棋、象棋、围棋编写简单 AI，可以采用 Minimax、Alpha-Beta 剪枝、Monte-Carlo Tree Search 等算法，实现单机对战。</li>
</ul>
</li>
<li><p><strong>健康模块与第三方服务对接</strong></p>
<ul>
<li>集成真实医院挂号 API（如国家、省市医院统一挂号平台）、在线问诊接口。</li>
<li>用 <strong>WorkManager</strong> 做本地用药提醒，结合 Room 数据库存储提醒记录，并支持前台通知。</li>
</ul>
</li>
<li><p><strong>无障碍与中老年优化</strong></p>
<ul>
<li>支持动态字体：在 <code>MaterialTheme</code> 中允许用户根据系统字体大小自动缩放</li>
<li>添加 <strong>TalkBack</strong> 描述：为按钮、Image、Canvas 等 UI 元素添加无障碍标签</li>
<li>增加高对比度模式切换，以便色盲 &#x2F; 视力低下用户使用</li>
</ul>
</li>
<li><p><strong>UI&#x2F;代码复用</strong></p>
<ul>
<li>将常见的圆形按钮、卡片组件提炼为 <code>ElderlyButton</code>、<code>FeatureCard</code> 等可复用组件</li>
<li>每个游戏模块的重置、悔棋、胜利提示等逻辑可统一抽象出基类函数</li>
</ul>
</li>
<li><p><strong>版本与测试覆盖</strong></p>
<ul>
<li>使用 <strong>Compose UI Test</strong> 编写界面测试，验证登录流程、导航正确性、游戏胜负判定等关键逻辑</li>
<li>使用 <strong>JUnit 5</strong> 完成单元测试，针对 <code>checkWin()</code>、棋子合法落子函数等核心算法做充分验证</li>
</ul>
</li>
</ol>
<hr>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>“<strong>MyElderlyApp</strong>” 项目旨在为中老年用户提供一个简单易用、功能全面的移动应用示例，从登录认证到多模块集成，从页面布局到自定义 Canvas、从 Firebase Auth 到后续可扩展的 Room 数据库，涵盖了完整的移动端开发流程。</p>
<ul>
<li><p><strong>项目收获</strong>：</p>
<ol>
<li>深入理解 Jetpack Compose 多路由导航与状态管理；</li>
<li>掌握 Canvas 自绘与原生 View 嵌入的区别与实践；</li>
<li>熟悉 Firebase Auth 使用与 Compose 配合；</li>
<li>提升了面向中老年群体的 UI&#x2F;UX 设计思路。</li>
</ol>
</li>
<li><p><strong>未来挑战</strong>：</p>
<ol>
<li>如何在保证中老年用户可用性的前提下，继续丰富功能模块（如健康数据可视化、AI 对弈）；</li>
<li>如何在实际产品中做到线上线下数据同步，提供更完善的健康与服务生态；</li>
<li>如何持续维护与测试，保证项目质量，并根据用户反馈不断迭代。</li>
</ol>
</li>
</ul>
<p>希望本文及附带完整源码对您在移动端开发、游戏逻辑实现及中老年应用设计方面有所帮助。欢迎在评论区讨论、给出建议或指出问题。祝您开发顺利！</p>
<hr>
<blockquote>
<p><strong>下载链接</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/huppee/myelderlyapp">项目完整代码（GitHub 仓库）</a></li>
<li>如果需要进一步集成 Firebase、Room 等，可参考仓库中的 <code>README.md</code> 进行配置。</li>
</ul>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://huppee.github.io/huppe.github.io">huppe</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://huppee.github.io/huppe.github.io/2025/06/03/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%B0%8F%E4%BD%9C%E4%B8%9A/">https://huppee.github.io/huppe.github.io/2025/06/03/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%B0%8F%E4%BD%9C%E4%B8%9A/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://huppee.github.io/huppe.github.io" target="_blank">huppe's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/huppe.github.io/tags/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/">软件开发</a></div><div class="post-share"><div class="social-share" data-image="/huppe.github.io/img/butterfly-icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/huppe.github.io/2025/05/08/Jave%E8%AF%AD%E8%A8%80%E7%AC%94%E8%AE%B0/" title="JAVA语言笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">JAVA语言笔记</div></div><div class="info-2"><div class="info-item-1">全面 Java 学习笔记这份笔记为已经熟悉 Python 的计算机学生设计，旨在帮助你全面掌握 Java 语言及其在软件开发中的应用。内容从基础到进阶，包含详细注释的代码示例，逻辑清晰，适合系统学习和实践。 1. Java 基础语法1.1 基本介绍 Java 是一种静态类型、面向对象的编程语言，通过 JVM（Java 虚拟机）实现跨平台运行。 程序入口点是 public static void main(String[] args) 方法，必须定义在类中。 示例代码：12345678910/** * 基础语法示例：Hello World 程序 */public class HelloWorld &#123;    // 程序入口点，JVM 从这里开始执行    public static void main(String[] args) &#123;        // 打印欢迎信息到控制台        System.out.println(&quot;Welcome to Java!&quot;);    &#125;&#125;  1.2...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/huppe.github.io/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/huppe.github.io/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">huppe</div><div class="author-info-description">Welcome to huppe's Blog! Sharing my journey.</div><div class="site-data"><a href="/huppe.github.io/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/huppe.github.io/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/huppe.github.io/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/huppee"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MyElderlyApp%EF%BC%9A%E4%B8%80%E6%AC%BE%E9%9D%A2%E5%90%91%E4%B8%AD%E8%80%81%E5%B9%B4%E7%94%A8%E6%88%B7%E7%9A%84%E7%BB%BC%E5%90%88%E6%80%A7-Android-%E5%BA%94%E7%94%A8"><span class="toc-number">1.</span> <span class="toc-text">MyElderlyApp：一款面向中老年用户的综合性 Android 应用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95"><span class="toc-number">1.1.</span> <span class="toc-text">目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E8%83%8C%E6%99%AF%E4%B8%8E%E5%AE%9A%E4%BD%8D"><span class="toc-number">1.2.</span> <span class="toc-text">项目背景与定位</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%80%E6%9C%AF%E6%A0%88%E4%B8%8E%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88"><span class="toc-number">1.3.</span> <span class="toc-text">技术栈与架构概览</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.4.</span> <span class="toc-text">核心功能模块介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E4%B8%8E%E4%B8%BB%E7%95%8C%E9%9D%A2"><span class="toc-number">1.4.1.</span> <span class="toc-text">登录与主界面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%AB%E6%8D%B7%E5%87%BA%E8%A1%8C-QuickTravelScreen"><span class="toc-number">1.4.2.</span> <span class="toc-text">快捷出行 (QuickTravelScreen)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%81%A5%E5%BA%B7%E7%AE%A1%E7%90%86-HealthScreen"><span class="toc-number">1.4.3.</span> <span class="toc-text">健康管理 (HealthScreen)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E8%89%BA%E7%A4%BE%E5%8C%BA-ArtCommunityScreen"><span class="toc-number">1.4.4.</span> <span class="toc-text">文艺社区 (ArtCommunityScreen)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E5%AD%90%E6%A3%8B-GomokuScreen"><span class="toc-number">1.4.5.</span> <span class="toc-text">五子棋 (GomokuScreen)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AD%E5%9B%BD%E8%B1%A1%E6%A3%8B-ChessScreen"><span class="toc-number">1.4.6.</span> <span class="toc-text">中国象棋 (ChessScreen)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%B4%E6%A3%8B-GoGameScreen"><span class="toc-number">1.4.7.</span> <span class="toc-text">围棋 (GoGameScreen)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BA%BB%E5%B0%86-MahjongScreen"><span class="toc-number">1.4.8.</span> <span class="toc-text">麻将 (MahjongScreen)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E5%85%B3%E9%94%AE%E7%82%B9%E8%A7%A3%E6%9E%90"><span class="toc-number">1.5.</span> <span class="toc-text">实现关键点解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E6%BA%90%E7%A0%81%EF%BC%88Markdown-%E6%A0%BC%E5%BC%8F%EF%BC%89"><span class="toc-number">1.6.</span> <span class="toc-text">项目源码（Markdown 格式）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LoginScreen-kt"><span class="toc-number">1.6.1.</span> <span class="toc-text">LoginScreen.kt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MainActivity-kt"><span class="toc-number">1.6.2.</span> <span class="toc-text">MainActivity.kt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#QuickTravelScreen-kt"><span class="toc-number">1.6.3.</span> <span class="toc-text">QuickTravelScreen.kt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HealthScreen-kt"><span class="toc-number">1.6.4.</span> <span class="toc-text">HealthScreen.kt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ArtCommunityScreen-kt"><span class="toc-number">1.6.5.</span> <span class="toc-text">ArtCommunityScreen.kt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GomokuScreen-kt"><span class="toc-number">1.6.6.</span> <span class="toc-text">GomokuScreen.kt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ChessScreen-kt"><span class="toc-number">1.6.7.</span> <span class="toc-text">ChessScreen.kt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GoGameScreen-kt"><span class="toc-number">1.6.8.</span> <span class="toc-text">GoGameScreen.kt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MahjongScreen-kt"><span class="toc-number">1.6.9.</span> <span class="toc-text">MahjongScreen.kt</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E6%94%B9%E8%BF%9B%E4%B8%8E%E6%9C%AA%E6%9D%A5%E5%B1%95%E6%9C%9B"><span class="toc-number">1.7.</span> <span class="toc-text">可改进与未来展望</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AF%AD"><span class="toc-number">1.8.</span> <span class="toc-text">结语</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/huppe.github.io/2025/06/03/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%B0%8F%E4%BD%9C%E4%B8%9A/" title="程序设计小作业">程序设计小作业</a><time datetime="2025-06-03T10:00:00.000Z" title="发表于 2025-06-03 18:00:00">2025-06-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/huppe.github.io/2025/05/08/Jave%E8%AF%AD%E8%A8%80%E7%AC%94%E8%AE%B0/" title="JAVA语言笔记">JAVA语言笔记</a><time datetime="2025-05-08T07:00:00.000Z" title="发表于 2025-05-08 15:00:00">2025-05-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/huppe.github.io/2025/04/20/Python%20%E8%AF%AD%E8%A8%80%E7%AC%94%E8%AE%B0/" title="Python语言笔记">Python语言笔记</a><time datetime="2025-04-20T04:00:00.000Z" title="发表于 2025-04-20 12:00:00">2025-04-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/huppe.github.io/2025/04/20/ssh%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95%E9%85%8D%E7%BD%AE%E7%AC%94%E8%AE%B0/" title="SSH 免密登录配置笔记">SSH 免密登录配置笔记</a><time datetime="2025-04-20T02:00:00.000Z" title="发表于 2025-04-20 10:00:00">2025-04-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/huppe.github.io/2025/03/01/pikachu%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3writeup/" title="Pikachu 靶场暴力破解">Pikachu 靶场暴力破解</a><time datetime="2025-03-01T15:09:54.000Z" title="发表于 2025-03-01 23:09:54">2025-03-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By huppe</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Powered by Hexo & Butterfly Theme</div></div><!-- 添加 Live2D 看板娘--><div class="waifu"><div class="waifu-tips"></div><canvas id="live2d" width="300" height="300"></canvas><div class="waifu-tool"><span class="fa fa-lg fa-comment"></span><span class="fa fa-lg fa-paper-plane"></span><span class="fa fa-lg fa-user-circle"></span><span class="fa fa-lg fa-street-view"></span><span class="fa fa-lg fa-camera-retro"></span><span class="fa fa-lg fa-times"></span></div></div><!-- 引入 Live2D 所需的 CSS 和 JavaScript--><script src="/huppe.github.io/live2d-widget/live2d.min.js"></script><script src="/huppe.github.io/live2d-widget/waifu-tips.js"></script><script src="/huppe.github.io/live2d-widget/autoload.js"></script><link rel="stylesheet" href="/huppe.github.io/live2d-widget/waifu.css"/></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><script src="/js/particles.min.js"></script><script>particlesJS.load('particles-js', '/json/particles.json', function() {
  console.log('Particles.js loaded');
});
</script><div><script src="/huppe.github.io/js/utils.js"></script><script src="/huppe.github.io/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><!-- 新增：动态背景脚本--><script src="/js/particles.min.js"></script><script>particlesJS.load('particles-js', '/json/particles.json', function() {
  console.log('Particles.js loaded');
})</script></div></body></html>